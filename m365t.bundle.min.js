!function i(s,u,l){function c(t,e){if(!u[t]){if(!s[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(a)return a(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var o=u[t]={exports:{}};s[t][0].call(o.exports,function(e){return c(s[t][1][e]||e)},o,o.exports,i,s,u,l)}return u[t].exports}for(var a="function"==typeof require&&require,e=0;e<l.length;e++)c(l[e]);return c}({1:[function(e,t,n){e("promise-polyfill"),e("isomorphic-unfetch");var o={url:"https://velingeorgiev.sharepoint.com/sites/s1",auth:function(){return fetch(this.url+"/_api/contextinfo",{headers:{Accept:"application/json;odata=nometadata","Content-type":"application/json;odata=nometadata"},method:"POST"}).then(function(e){return e.ok?e.json():Promise.reject(e)})},e:encodeURIComponent,def:{headers:function(e,t){var n={Accept:"application/json;odata=nometadata","Content-type":"application/json;odata=nometadata","user-agent":"NONISV|SharePointPnP|VelinGeorgievToolset/1.0.0","X-RequestDigest":e.FormDigestValue};return t&&(n["X-HTTP-Method"]="MERGE",n["If-Match"]="*"),n},json:function(e){return e.ok||console.log(e),e.json()},success:function(e){return console.log(e),Promise.resolve(e)},error:function(e){console.log(e)},get:function(t){return o.auth().then(function(e){return fetch(o.url+t,{headers:o.def.headers(e)})}).then(o.def.json).then(o.def.success).catch(o.def.error)},post:function(t,n,r){return o.auth().then(function(e){return fetch(o.url+t,{headers:o.def.headers(e,r),method:"POST",body:JSON.stringify(n)})}).then(o.def.success).catch(o.def.error)}},user:{search:function(e){return o.def.get("/_api/search/query?querytext='"+o.e(e)+"'&selectproperties='UserName,Title,JobTitle,WorkPhone'&sourceid='b09a7990-05ea-4af9-81ef-edfab16c4e31'&clienttype='PeopleResultsQuery'").then(function(e){for(var t=e.PrimaryQueryResult.RelevantResults.Table.Rows,n=t.length,r=[];n--;){var o=t[n].Cells.filter(function(e){return"UserName"===e.Key})[0];r.push({email:o.Value,props:t[n]})}return console.log(r),Promise.resolve(r)}).catch(o.def.error)},get:function(e){return o.def.get("/_api/SP.UserProfiles.PeopleManager/GetPropertiesFor(accountName=@v)?@v='"+o.e("i:0#.f|membership|"+e)+"'")},me:function(){return o.def.get("/_api/SP.UserProfiles.PeopleManager/GetMyProperties")}},search:function(n,r){return o.auth().then(function(e){var t=o.url+"/_api/search/query?querytext='"+o.e(n)+"'";return r&&(t+="&selectproperties='"+r+"'"),fetch(t,{headers:o.def.headers(e)})}).then(o.def.json).then(function(e){var t=e.PrimaryQueryResult.RelevantResults.Table.Rows;return console.log(t),Promise.resolve(t)}).catch(o.def.error)},site:{get:function(){return o.def.get("/_api/site")},properties:function(){return o.def.get("/_api/site/AllProperties")}},web:{get:function(){return o.def.get("/_api/web")},properties:function(){return o.def.get("/_api/web/AllProperties")},getRegionalSettings:function(){return o.def.get("/_api/web/regionalsettings")}},list:{addList:function(e,t){return o.def.post("/_api/web/lists",{Title:e,BaseTemplate:t||100,ContentTypesEnabled:!0,AllowContentTypes:!0,EnableVersioning:!0})},addLibrary:function(e){return o.def.post("/_api/web/lists",{Title:e,BaseTemplate:101,ContentTypesEnabled:!0,AllowContentTypes:!0,EnableVersioning:!0,EnableFolderCreation:!0})},all:function(){return o.def.get("/_api/web/lists")},titles:function(){return o.def.get("/_api/web/lists").then(function(e){for(var t=[],n=e.value.length;n--;)t.push(e.value[n].Title),console.log(e.value[n].Title);return Promise.resolve(t)}).catch(o.def.error)},get:function(e){return o.def.get("/_api/web/lists/GetByTitle('"+o.e(e)+"')")},getFields:function(e){return o.def.get("/_api/web/lists/GetByTitle('"+o.e(e)+"')/fields").then(function(e){return console.log(e.value),Promise.resolve(e.value)}).catch(o.def.error)},getFieldsTitles:function(e){return o.def.get("/_api/web/lists/GetByTitle('"+o.e(e)+"')/fields").then(function(e){for(var t=[],n=e.value.length;n--;){var r=e.value[n],o=r.Title+", "+r.TypeAsString+", "+r.InternalName+", "+(1==r.Indexed?">> INDEXED":"");console.log(o),t.push(o)}return Promise.resolve(t)}).catch(o.def.error)},setHidden:function(e,t){return o.def.post("/_api/web/lists/GetByTitle('"+o.e(e)+"')",{Hidden:t},!0)},setTitle:function(e,t){return o.def.post("/_api/web/lists/GetByTitle('"+o.e(e)+"')",{Title:t},!0)},setModeration:function(e,t){return o.def.post("/_api/web/lists/GetByTitle('"+o.e(e)+"')",{EnableModeration:t},!0)},setVersioning:function(e,t){return o.def.post("/_api/web/lists/GetByTitle('"+o.e(e)+"')",{EnableVersioning:t},!0)},setFolderCreation:function(e,t){return o.def.post("/_api/web/lists/GetByTitle('"+o.e(e)+"')",{EnableFolderCreation:t},!0)},setContentTypes:function(e,t){return o.def.post("/_api/web/lists/GetByTitle('"+o.e(e)+"')",{AllowContentTypes:t,ContentTypesEnabled:t},!0)}},view:{all:function(e){return o.def.get("/_api/lists/getByTitle('"+o.e(e)+"')/views").then(function(e){return console.log(e.value),Promise.resolve(e.value)}).catch(o.def.error)},get:function(e,t){return o.def.get("/_api/web/lists/GetByTitle('"+o.e(e)+"')/views/GetByTitle('"+o.e(t)+"')")},setHidden:function(e,t,n){return o.def.post("/_api/web/lists/GetByTitle('"+o.e(e)+"')/views/GetByTitle('"+o.e(t)+"')",{Hidden:n},!0)},setViewQuery:function(e,t,n){return o.def.post("/_api/web/lists/GetByTitle('"+o.e(e)+"')/views/GetByTitle('"+o.e(t)+"')",{ViewQuery:n},!0)},setRowLimit:function(e,t,n){return o.def.post("/_api/web/lists/GetByTitle('"+o.e(e)+"')/views/GetByTitle('"+o.e(t)+"')",{RowLimit:n},!0)},setFormatter:function(e,t,n){return o.def.post("/_api/web/lists/GetByTitle('"+o.e(e)+"')/views/GetByTitle('"+o.e(t)+"')",{CustomFormatter:JSON.stringify(n)},!0)}},field:{setFormatter:function(e,t,n){return o.def.post("/_api/web/lists/GetByTitle('"+o.e(e)+"')/Fields/GetByInternalNameOrTitle('"+o.e(t)+"')",{CustomFormatter:JSON.stringify(n)},!0)}}};window&&(window.s=o)},{"isomorphic-unfetch":2,"promise-polyfill":4}],2:[function(e,t,n){t.exports=window.fetch||(window.fetch=e("unfetch").default||e("unfetch"))},{unfetch:6}],3:[function(e,t,n){var r,o,i=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function l(t){if(r===setTimeout)return setTimeout(t,0);if((r===s||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:s}catch(e){r=s}try{o="function"==typeof clearTimeout?clearTimeout:u}catch(e){o=u}}();var c,a=[],f=!1,d=-1;function p(){f&&c&&(f=!1,c.length?a=c.concat(a):d=-1,a.length&&h())}function h(){if(!f){var e=l(p);f=!0;for(var t=a.length;t;){for(c=a,a=[];++d<t;)c&&c[d].run();d=-1,t=a.length}c=null,f=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===u||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function y(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.push(new m(e,t)),1!==a.length||f||l(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=y,i.addListener=y,i.once=y,i.off=y,i.removeListener=y,i.removeAllListeners=y,i.emit=y,i.prependListener=y,i.prependOnceListener=y,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],4:[function(e,d,t){(function(t){"use strict";var n=setTimeout;function l(e){return Boolean(e&&void 0!==e.length)}function r(){}function i(e){if(!(this instanceof i))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(e,this)}function o(n,r){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,i._immediateFn(function(){var e=1===n._state?r.onFulfilled:r.onRejected;if(null!==e){var t;try{t=e(n._value)}catch(e){return void u(r.promise,e)}s(r.promise,t)}else(1===n._state?s:u)(r.promise,n._value)})):n._deferreds.push(r)}function s(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof i)return t._state=3,t._value=e,void c(t);if("function"==typeof n)return void f((r=n,o=e,function(){r.apply(o,arguments)}),t)}t._state=1,t._value=e,c(t)}catch(e){u(t,e)}var r,o}function u(e,t){e._state=2,e._value=t,c(e)}function c(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)o(e,e._deferreds[t]);e._deferreds=null}function a(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function f(e,t){var n=!1;try{e(function(e){n||(n=!0,s(t,e))},function(e){n||(n=!0,u(t,e))})}catch(e){if(n)return;n=!0,u(t,e)}}i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=new this.constructor(r);return o(this,new a(e,t,n)),n},i.prototype.finally=function(t){var n=this.constructor;return this.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){return n.reject(e)})})},i.all=function(t){return new i(function(r,o){if(!l(t))return o(new TypeError("Promise.all accepts an array"));var i=Array.prototype.slice.call(t);if(0===i.length)return r([]);var s=i.length;function u(t,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void n.call(e,function(e){u(t,e)},o)}i[t]=e,0==--s&&r(i)}catch(e){o(e)}}for(var e=0;e<i.length;e++)u(e,i[e])})},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i(function(e){e(t)})},i.reject=function(n){return new i(function(e,t){t(n)})},i.race=function(o){return new i(function(e,t){if(!l(o))return t(new TypeError("Promise.race accepts an array"));for(var n=0,r=o.length;n<r;n++)i.resolve(o[n]).then(e,t)})},i._immediateFn="function"==typeof t?function(e){t(e)}:function(e){n(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},d.exports=i}).call(this,e("timers").setImmediate)},{timers:5}],5:[function(l,e,c){(function(e,t){var r=l("process/browser.js").nextTick,n=Function.prototype.apply,o=Array.prototype.slice,i={},s=0;function u(e,t){this._id=e,this._clearFn=t}c.setTimeout=function(){return new u(n.call(setTimeout,window,arguments),clearTimeout)},c.setInterval=function(){return new u(n.call(setInterval,window,arguments),clearInterval)},c.clearTimeout=c.clearInterval=function(e){e.close()},u.prototype.unref=u.prototype.ref=function(){},u.prototype.close=function(){this._clearFn.call(window,this._id)},c.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},c.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},c._unrefActive=c.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},c.setImmediate="function"==typeof e?e:function(e){var t=s++,n=!(arguments.length<2)&&o.call(arguments,1);return i[t]=!0,r(function(){i[t]&&(n?e.apply(null,n):e.call(null),c.clearImmediate(t))}),t},c.clearImmediate="function"==typeof t?t:function(e){delete i[e]}}).call(this,l("timers").setImmediate,l("timers").clearImmediate)},{"process/browser.js":3,timers:5}],6:[function(e,t,n){t.exports=function(l,c){return c=c||{},new Promise(function(e,t){var n=new XMLHttpRequest,r=[],o=[],i={},s=function(){return{ok:2==(n.status/100|0),statusText:n.statusText,status:n.status,url:n.responseURL,text:function(){return Promise.resolve(n.responseText)},json:function(){return Promise.resolve(JSON.parse(n.responseText))},blob:function(){return Promise.resolve(new Blob([n.response]))},clone:s,headers:{keys:function(){return r},entries:function(){return o},get:function(e){return i[e.toLowerCase()]},has:function(e){return e.toLowerCase()in i}}}};for(var u in n.open(c.method||"get",l,!0),n.onload=function(){n.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(e,t,n){r.push(t=t.toLowerCase()),o.push([t,n]),i[t]=i[t]?i[t]+","+n:n}),e(s())},n.onerror=t,n.withCredentials="include"==c.credentials,c.headers)n.setRequestHeader(u,c.headers[u]);n.send(c.body||null)})}},{}]},{},[1]);