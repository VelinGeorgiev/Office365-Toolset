!function(e){"object"==typeof exports&&"undefined"!=typeof module?e():"function"==typeof define&&define.amd?define(e):e()}(function(){"use strict";function e(t){var n=this.constructor;return this.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){return n.reject(e)})})}function u(e){return e&&void 0!==e.length}function n(){}function s(e){if(!(this instanceof s))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],c(e,this)}function o(n,r){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,s._immediateFn(function(){var e=1===n._state?r.onFulfilled:r.onRejected;if(null!==e){var t;try{t=e(n._value)}catch(e){return void a(r.promise,e)}i(r.promise,t)}else(1===n._state?i:a)(r.promise,n._value)})):n._deferreds.push(r)}function i(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with its.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof s)return t._state=3,t._value=e,void f(t);if("function"==typeof n)return void c((r=n,o=e,function(){r.apply(o,arguments)}),t)}t._state=1,t._value=e,f(t)}catch(e){a(t,e)}var r,o}function a(e,t){e._state=2,e._value=t,f(e)}function f(e){2===e._state&&0===e._deferreds.length&&s._immediateFn(function(){e._handled||s._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)o(e,e._deferreds[t]);e._deferreds=null}function c(e,t){var n=!1;try{e(function(e){n||(n=!0,i(t,e))},function(e){n||(n=!0,a(t,e))})}catch(e){if(n)return;n=!0,a(t,e)}}var t=setTimeout;s.prototype.catch=function(e){return this.then(null,e)},s.prototype.then=function(r,e){var t=new this.constructor(n);return o(this,new function(e,t,n){this.onFulfilled="function"==typeof r?r:null,this.onRejected="function"==typeof t?t:null,this.promise=n}(r,e,t)),t},s.prototype.finally=e,s.all=function(t){return new s(function(r,o){function s(t,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void n.call(e,function(e){s(t,e)},o)}i[t]=e,0==--a&&r(i)}catch(e){o(e)}}if(!u(t))return o(new TypeError("Promise.all accepts an array"));var i=Array.prototype.slice.call(t);if(0===i.length)return r([]);for(var a=i.length,e=0;i.length>e;e++)s(e,i[e])})},s.resolve=function(t){return t&&"object"==typeof t&&t.constructor===s?t:new s(function(e){e(t)})},s.reject=function(n){return new s(function(e,t){t(n)})},s.race=function(o){return new s(function(e,t){if(!u(o))return t(new TypeError("Promise.race accepts an array"));for(var n=0,r=o.length;n<r;n++)s.resolve(o[n]).then(e,t)})},s._immediateFn="function"==typeof setImmediate?function(e){setImmediate(e)}:function(e){t(e,0)},s._unhandledRejectionFn=function(e){void 0!==console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var r=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw Error("unable to locate global object")}();"Promise"in r?r.Promise.prototype.finally||(r.Promise.prototype.finally=e):r.Promise=s}),function(e){"use strict";if(!e.fetch){var t="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,i="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),r="FormData"in e,o="ArrayBuffer"in e;if(o)var s=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=function(e){return e&&DataView.prototype.isPrototypeOf(e)},u=ArrayBuffer.isView||function(e){return e&&-1<s.indexOf(Object.prototype.toString.call(e))};p.prototype.append=function(e,t){e=h(e),t=d(t);var n=this.map[e];this.map[e]=n?n+","+t:t},p.prototype.delete=function(e){delete this.map[h(e)]},p.prototype.get=function(e){return e=h(e),this.has(e)?this.map[e]:null},p.prototype.has=function(e){return this.map.hasOwnProperty(h(e))},p.prototype.set=function(e,t){this.map[h(e)]=d(t)},p.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},p.prototype.keys=function(){var n=[];return this.forEach(function(e,t){n.push(t)}),l(n)},p.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),l(t)},p.prototype.entries=function(){var n=[];return this.forEach(function(e,t){n.push([t,e])}),l(n)},n&&(p.prototype[Symbol.iterator]=p.prototype.entries);var f=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];T.prototype.clone=function(){return new T(this,{body:this._bodyInit})},v.call(T.prototype),v.call(g.prototype),g.prototype.clone=function(){return new g(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},g.error=function(){var e=new g(null,{status:0,statusText:""});return e.type="error",e};var c=[301,302,303,307,308];g.redirect=function(e,t){if(-1===c.indexOf(t))throw new RangeError("Invalid status code");return new g(null,{status:t,headers:{location:e}})},e.Headers=p,e.Request=T,e.Response=g,e.fetch=function(n,o){return new Promise(function(r,e){var t=new T(n,o),s=new XMLHttpRequest;s.onload=function(){var e,o,t={status:s.status,statusText:s.statusText,headers:(e=s.getAllResponseHeaders()||"",o=new p,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var t=e.split(":"),n=t.shift().trim();if(n){var r=t.join(":").trim();o.append(n,r)}}),o)};t.url="responseURL"in s?s.responseURL:t.headers.get("X-Request-URL");var n="response"in s?s.response:s.responseText;r(new g(n,t))},s.onerror=function(){e(new TypeError("Network request failed"))},s.ontimeout=function(){e(new TypeError("Network request failed"))},s.open(t.method,t.url,!0),"include"===t.credentials?s.withCredentials=!0:"omit"===t.credentials&&(s.withCredentials=!1),"responseType"in s&&i&&(s.responseType="blob"),t.headers.forEach(function(e,t){s.setRequestHeader(t,e)}),s.send(void 0===t._bodyInit?null:t._bodyInit)})},e.fetch.polyfill=!0}function h(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function d(e){return"string"!=typeof e&&(e=String(e)),e}function l(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return n&&(e[Symbol.iterator]=function(){return e}),e}function p(t){this.map={},t instanceof p?t.forEach(function(e,t){this.append(t,e)},this):Array.isArray(t)?t.forEach(function(e){this.append(e[0],e[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function y(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function m(n){return new Promise(function(e,t){n.onload=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function b(e){var t=new FileReader,n=m(t);return t.readAsArrayBuffer(e),n}function w(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function v(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e)if("string"==typeof e)this._bodyText=e;else if(i&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(r&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(o&&i&&a(e))this._bodyArrayBuffer=w(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!o||!ArrayBuffer.prototype.isPrototypeOf(e)&&!u(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=w(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var e=y(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?y(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(b)}),this.text=function(){var e,t,n,r=y(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,n=m(t=new FileReader),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},r&&(this.formData=function(){return this.text().then(_)}),this.json=function(){return this.text().then(JSON.parse)},this}function T(e,t){var n,r,o=(t=t||{}).body;if(e instanceof T){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new p(e.headers)),this.method=e.method,this.mode=e.mode,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new p(t.headers)),this.method=(r=(n=t.method||this.method||"GET").toUpperCase(),-1<f.indexOf(r)?r:n),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function _(e){var o=new FormData;return e.trim().split("&").forEach(function(e){if(e){var t=e.split("="),n=t.shift().replace(/\+/g," "),r=t.join("=").replace(/\+/g," ");o.append(decodeURIComponent(n),decodeURIComponent(r))}}),o}function g(e,t){t=t||{},this.type="default",this.status=void 0===t.status?200:t.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new p(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:this);var s={url:"https://velingeorgiev.sharepoint.com/sites/s1",auth:function(){return fetch(this.url+"/_api/contextinfo",{headers:{Accept:"application/json;odata=nometadata","Content-type":"application/json;odata=nometadata"},method:"POST"}).then(function(e){return e.ok?e.json():Promise.reject(e)})},def:{headers:function(e,t){var n={Accept:"application/json;odata=nometadata","Content-type":"application/json;odata=nometadata","user-agent":"NONISV|SharePointPnP|VelinGeorgievToolset/1.0.0","X-RequestDigest":e.FormDigestValue};return t&&(n["X-HTTP-Method"]="MERGE",n["If-Match"]="*"),n},json:function(e){return e.ok||console.log(e),e.json()},success:function(e){return console.log(e),Promise.resolve(e)},error:function(e){console.log(e)}},user:{search:function(t){return s.auth().then(function(e){return fetch(s.url+"/_api/search/query?querytext='"+encodeURIComponent(t)+"'&selectproperties='UserName,Title,JobTitle,WorkPhone'&sourceid='b09a7990-05ea-4af9-81ef-edfab16c4e31'&clienttype='PeopleResultsQuery'",{headers:s.def.headers(e)})}).then(s.def.json).then(function(e){for(var t=e.PrimaryQueryResult.RelevantResults.Table.Rows,n=t.length,r=[];n--;){var o=t[n].Cells.filter(function(e){return"UserName"===e.Key})[0];r.push({email:o.Value,props:t[n]})}return console.log(r),Promise.resolve(r)}).catch(s.def.error)},get:function(t){return s.auth().then(function(e){return fetch(s.url+"/_api/SP.UserProfiles.PeopleManager/GetPropertiesFor(accountName=@v)?@v='"+encodeURIComponent("i:0#.f|membership|"+t)+"'",{headers:s.def.headers(e)})}).then(s.def.json).then(s.def.success).catch(s.def.error)},me:function(){return s.auth().then(function(e){return fetch(s.url+"/_api/SP.UserProfiles.PeopleManager/GetMyProperties",{headers:s.def.headers(e)})}).then(s.def.json).then(s.def.success).catch(s.def.error)}},search:function(n,r){return s.auth().then(function(e){var t=s.url+"/_api/search/query?querytext='"+encodeURIComponent(n)+"'";return r&&(t+="&selectproperties='"+r+"'"),fetch(t,{headers:s.def.headers(e)})}).then(s.def.json).then(function(e){var t=e.PrimaryQueryResult.RelevantResults.Table.Rows;return console.log(t),Promise.resolve(t)}).catch(s.def.error)},web:{get:function(){return s.auth().then(function(e){return fetch(s.url+"/_api/web",{headers:s.def.headers(e)})}).then(s.def.json).then(s.def.success).catch(s.def.error)},getRegionalSettings:function(){return s.auth().then(function(e){return fetch(s.url+"/_api/web/regionalsettings",{headers:s.def.headers(e)})}).then(s.def.json).then(s.def.success).catch(s.def.error)}},site:{get:function(){return s.auth().then(function(e){return fetch(s.url+"/_api/web",{headers:s.def.headers(e)})}).then(s.def.json).then(s.def.success).catch(s.def.error)}},list:{addList:function(t,n){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists",{headers:s.def.headers(e),method:"POST",body:JSON.stringify({Title:t,BaseTemplate:n||100,ContentTypesEnabled:!0,AllowContentTypes:!0,EnableVersioning:!0})})}).then(s.def.success).catch(s.def.error)},addLibrary:function(t){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists",{headers:s.def.headers(e),method:"POST",body:JSON.stringify({Title:t,BaseTemplate:101,ContentTypesEnabled:!0,AllowContentTypes:!0,EnableVersioning:!0,EnableFolderCreation:!0})})}).then(s.def.success).catch(s.def.error)},all:function(){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists?$expand=RootFolder",{headers:s.def.headers(e)})}).then(s.def.json).then(function(e){return console.log(e.value),Promise.resolve(e.value)}).catch(s.def.error)},allTitles:function(){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists?$expand=RootFolder",{headers:s.def.headers(e)})}).then(s.def.json).then(function(e){for(var t=[],n=e.value.length;n--;)t.push(e.value[n].Title),console.log(e.value[n].Title);return Promise.resolve(t)}).catch(s.def.error)},get:function(t){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+encodeURIComponent(t)+"')",{headers:s.def.headers(e)})}).then(s.def.json).then(s.def.success).catch(s.def.error)},getFields:function(t){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+encodeURIComponent(t)+"')/fields",{headers:s.def.headers(e)})}).then(s.def.json).then(function(e){return console.log(e.value),Promise.resolve(e.value)}).catch(s.def.error)},getFieldsTitles:function(t){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+encodeURIComponent(t)+"')/fields",{headers:s.def.headers(e)})}).then(s.def.json).then(function(e){for(var t=[],n=e.value.length;n--;){var r=e.value[n],o=r.Title+", "+r.TypeAsString+", "+r.InternalName+", "+(1==r.Indexed?">> INDEXED":"");console.log(o),t.push(o)}return Promise.resolve(t)}).catch(s.def.error)},setHidden:function(t,n){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+encodeURIComponent(t)+"')",{headers:s.def.headers(e,!0),method:"POST",body:JSON.stringify({Hidden:n})})}).then(s.def.success).catch(s.def.error)},setTitle:function(t,n){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+encodeURIComponent(t)+"')",{headers:s.def.headers(e,!0),method:"POST",body:JSON.stringify({Title:n})})}).then(s.def.success).catch(s.def.error)},setModeration:function(t,n){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+encodeURIComponent(t)+"')",{headers:s.def.headers(e,!0),method:"POST",body:JSON.stringify({EnableModeration:n})})}).then(s.def.success).catch(s.def.error)},setVersioning:function(t,n){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+encodeURIComponent(t)+"')",{headers:s.def.headers(e,!0),method:"POST",body:JSON.stringify({EnableVersioning:n})})}).then(s.def.success).catch(s.def.error)},setFolderCreation:function(t,n){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+encodeURIComponent(t)+"')",{headers:s.def.headers(e,!0),method:"POST",body:JSON.stringify({EnableFolderCreation:n})})}).then(s.def.success).catch(s.def.error)},setContentTypes:function(t,n){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+encodeURIComponent(t)+"')",{headers:s.def.headers(e,!0),method:"POST",body:JSON.stringify({AllowContentTypes:n,ContentTypesEnabled:n})})}).then(s.def.success).catch(s.def.error)}},view:{all:function(t){return s.auth().then(function(e){return fetch(s.url+"/_api/lists/getByTitle('"+encodeURIComponent(t)+"')/views",{headers:s.def.headers(e)})}).then(s.def.json).then(function(e){return console.log(e.value),Promise.resolve(e.value)}).catch(s.def.error)},get:function(t,n){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+encodeURIComponent(t)+"')/views/GetByTitle('"+encodeURIComponent(n)+"')",{headers:s.def.headers(e)})}).then(s.def.json).then(s.def.success).catch(s.def.error)},setHidden:function(t,n,r){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+encodeURIComponent(t)+"')/views/GetByTitle('"+encodeURIComponent(n)+"')",{headers:s.def.headers(e,!0),method:"POST",body:JSON.stringify({Hidden:r})})}).then(s.def.success).catch(s.def.error)},setViewQuery:function(t,n,r){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+encodeURIComponent(t)+"')/views/GetByTitle('"+encodeURIComponent(n)+"')",{headers:s.def.headers(e,!0),method:"POST",body:JSON.stringify({ViewQuery:r})})}).then(s.def.success).catch(s.def.error)},setRowLimit:function(t,n,r){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+encodeURIComponent(t)+"')/views/GetByTitle('"+encodeURIComponent(n)+"')",{headers:s.def.headers(e,!0),method:"POST",body:JSON.stringify({RowLimit:r})})}).then(s.def.success).catch(s.def.error)},setFormatter:function(t,n,r){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+encodeURIComponent(t)+"')/views/GetByTitle('"+encodeURIComponent(n)+"')",{headers:s.def.headers(e,!0),method:"POST",body:JSON.stringify({CustomFormatter:JSON.stringify(r)})})}).then(s.def.success).catch(s.def.error)}},field:{setFormatter:function(t,n,r){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+encodeURIComponent(t)+"')/Fields/GetByInternalNameOrTitle('"+encodeURIComponent(n)+"')",{headers:s.def.headers(e),method:"MERGE",body:JSON.stringify({CustomFormatter:JSON.stringify(r)})})}).then(s.def.success).catch(s.def.error)}}};