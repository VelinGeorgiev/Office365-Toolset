!function(e){"object"==typeof exports&&"undefined"!=typeof module?e():"function"==typeof define&&define.amd?define(e):e()}(function(){"use strict";function e(t){var r=this.constructor;return this.then(function(e){return r.resolve(t()).then(function(){return e})},function(e){return r.resolve(t()).then(function(){return r.reject(e)})})}function u(e){return e&&void 0!==e.length}function r(){}function o(e){if(!(this instanceof o))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],h(e,this)}function s(r,n){for(;3===r._state;)r=r._value;0!==r._state?(r._handled=!0,o._immediateFn(function(){var e=1===r._state?n.onFulfilled:n.onRejected;if(null!==e){var t;try{t=e(r._value)}catch(e){return void a(n.promise,e)}i(n.promise,t)}else(1===r._state?i:a)(n.promise,r._value)})):r._deferreds.push(n)}function i(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with its.");if(e&&("object"==typeof e||"function"==typeof e)){var r=e.then;if(e instanceof o)return t._state=3,t._value=e,void f(t);if("function"==typeof r)return void h((n=r,s=e,function(){n.apply(s,arguments)}),t)}t._state=1,t._value=e,f(t)}catch(e){a(t,e)}var n,s}function a(e,t){e._state=2,e._value=t,f(e)}function f(e){2===e._state&&0===e._deferreds.length&&o._immediateFn(function(){e._handled||o._unhandledRejectionFn(e._value)});for(var t=0,r=e._deferreds.length;t<r;t++)s(e,e._deferreds[t]);e._deferreds=null}function h(e,t){var r=!1;try{e(function(e){r||(r=!0,i(t,e))},function(e){r||(r=!0,a(t,e))})}catch(e){if(r)return;r=!0,a(t,e)}}var t=setTimeout;o.prototype.catch=function(e){return this.then(null,e)},o.prototype.then=function(n,e){var t=new this.constructor(r);return s(this,new function(e,t,r){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof t?t:null,this.promise=r}(n,e,t)),t},o.prototype.finally=e,o.all=function(t){return new o(function(n,s){function o(t,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var r=e.then;if("function"==typeof r)return void r.call(e,function(e){o(t,e)},s)}i[t]=e,0==--a&&n(i)}catch(e){s(e)}}if(!u(t))return s(new TypeError("Promise.all accepts an array"));var i=Array.prototype.slice.call(t);if(0===i.length)return n([]);for(var a=i.length,e=0;i.length>e;e++)o(e,i[e])})},o.resolve=function(t){return t&&"object"==typeof t&&t.constructor===o?t:new o(function(e){e(t)})},o.reject=function(r){return new o(function(e,t){t(r)})},o.race=function(s){return new o(function(e,t){if(!u(s))return t(new TypeError("Promise.race accepts an array"));for(var r=0,n=s.length;r<n;r++)o.resolve(s[r]).then(e,t)})},o._immediateFn="function"==typeof setImmediate?function(e){setImmediate(e)}:function(e){t(e,0)},o._unhandledRejectionFn=function(e){void 0!==console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var n=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw Error("unable to locate global object")}();"Promise"in n?n.Promise.prototype.finally||(n.Promise.prototype.finally=e):n.Promise=o}),function(e){"use strict";if(!e.fetch){var t="URLSearchParams"in e,r="Symbol"in e&&"iterator"in Symbol,i="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),n="FormData"in e,s="ArrayBuffer"in e;if(s)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=function(e){return e&&DataView.prototype.isPrototypeOf(e)},u=ArrayBuffer.isView||function(e){return e&&-1<o.indexOf(Object.prototype.toString.call(e))};p.prototype.append=function(e,t){e=c(e),t=d(t);var r=this.map[e];this.map[e]=r?r+","+t:t},p.prototype.delete=function(e){delete this.map[c(e)]},p.prototype.get=function(e){return e=c(e),this.has(e)?this.map[e]:null},p.prototype.has=function(e){return this.map.hasOwnProperty(c(e))},p.prototype.set=function(e,t){this.map[c(e)]=d(t)},p.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},p.prototype.keys=function(){var r=[];return this.forEach(function(e,t){r.push(t)}),l(r)},p.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),l(t)},p.prototype.entries=function(){var r=[];return this.forEach(function(e,t){r.push([t,e])}),l(r)},r&&(p.prototype[Symbol.iterator]=p.prototype.entries);var f=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];T.prototype.clone=function(){return new T(this,{body:this._bodyInit})},w.call(T.prototype),w.call(g.prototype),g.prototype.clone=function(){return new g(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},g.error=function(){var e=new g(null,{status:0,statusText:""});return e.type="error",e};var h=[301,302,303,307,308];g.redirect=function(e,t){if(-1===h.indexOf(t))throw new RangeError("Invalid status code");return new g(null,{status:t,headers:{location:e}})},e.Headers=p,e.Request=T,e.Response=g,e.fetch=function(r,s){return new Promise(function(n,e){var t=new T(r,s),o=new XMLHttpRequest;o.onload=function(){var e,s,t={status:o.status,statusText:o.statusText,headers:(e=o.getAllResponseHeaders()||"",s=new p,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var t=e.split(":"),r=t.shift().trim();if(r){var n=t.join(":").trim();s.append(r,n)}}),s)};t.url="responseURL"in o?o.responseURL:t.headers.get("X-Request-URL");var r="response"in o?o.response:o.responseText;n(new g(r,t))},o.onerror=function(){e(new TypeError("Network request failed"))},o.ontimeout=function(){e(new TypeError("Network request failed"))},o.open(t.method,t.url,!0),"include"===t.credentials?o.withCredentials=!0:"omit"===t.credentials&&(o.withCredentials=!1),"responseType"in o&&i&&(o.responseType="blob"),t.headers.forEach(function(e,t){o.setRequestHeader(t,e)}),o.send(void 0===t._bodyInit?null:t._bodyInit)})},e.fetch.polyfill=!0}function c(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function d(e){return"string"!=typeof e&&(e=String(e)),e}function l(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return r&&(e[Symbol.iterator]=function(){return e}),e}function p(t){this.map={},t instanceof p?t.forEach(function(e,t){this.append(t,e)},this):Array.isArray(t)?t.forEach(function(e){this.append(e[0],e[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function y(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function b(r){return new Promise(function(e,t){r.onload=function(){e(r.result)},r.onerror=function(){t(r.error)}})}function m(e){var t=new FileReader,r=b(t);return t.readAsArrayBuffer(e),r}function v(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function w(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e)if("string"==typeof e)this._bodyText=e;else if(i&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(n&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(s&&i&&a(e))this._bodyArrayBuffer=v(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!s||!ArrayBuffer.prototype.isPrototypeOf(e)&&!u(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=v(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var e=y(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?y(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(m)}),this.text=function(){var e,t,r,n=y(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,r=b(t=new FileReader),t.readAsText(e),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},n&&(this.formData=function(){return this.text().then(_)}),this.json=function(){return this.text().then(JSON.parse)},this}function T(e,t){var r,n,s=(t=t||{}).body;if(e instanceof T){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new p(e.headers)),this.method=e.method,this.mode=e.mode,s||null==e._bodyInit||(s=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new p(t.headers)),this.method=(n=(r=t.method||this.method||"GET").toUpperCase(),-1<f.indexOf(n)?n:r),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&s)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(s)}function _(e){var s=new FormData;return e.trim().split("&").forEach(function(e){if(e){var t=e.split("="),r=t.shift().replace(/\+/g," "),n=t.join("=").replace(/\+/g," ");s.append(decodeURIComponent(r),decodeURIComponent(n))}}),s}function g(e,t){t=t||{},this.type="default",this.status=void 0===t.status?200:t.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new p(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:this);var s={url:"https://velingeorgiev.sharepoint.com/sites/s1",auth:function(){return fetch(this.url+"/_api/contextinfo",{headers:{Accept:"application/json;odata=nometadata","Content-type":"application/json;odata=nometadata"},method:"POST"}).then(function(e){return e.ok?e.json():Promise.reject(e)})},def:{headers:function(e,t){var r={Accept:"application/json;odata=nometadata","Content-type":"application/json;odata=nometadata","user-agent":"NONISV|SharePointPnP|VelinGeorgievToolset/1.0.0","X-RequestDigest":e.FormDigestValue};return t&&(r["X-HTTP-Method"]="MERGE",r["If-Match"]="*"),r},json:function(e){return e.ok||console.log(e),e.json()},success:function(e){return console.log(e),Promise.resolve(e)},error:function(e){console.log(e)}},user:{search:function(t){return s.auth().then(function(e){return fetch(s.url+"/_api/search/query?querytext='"+t+"'&selectproperties='UserName,Title,JobTitle,WorkPhone'&sourceid='b09a7990-05ea-4af9-81ef-edfab16c4e31'&clienttype='PeopleResultsQuery'",{headers:s.def.headers(e)})}).then(s.def.json).then(function(e){for(var t=e.PrimaryQueryResult.RelevantResults.Table.Rows,r=t.length,n=[];r--;){var s=t[r].Cells.filter(function(e){return"UserName"===e.Key})[0];n.push({email:s.Value,props:t[r]})}return console.log(n),Promise.resolve(n)}).catch(s.def.error)},get:function(t){return s.auth().then(function(e){return fetch(s.url+"/_api/SP.UserProfiles.PeopleManager/GetPropertiesFor(accountName=@v)?@v='"+encodeURIComponent("i:0#.f|membership|"+t)+"'",{headers:s.def.headers(e)})}).then(s.def.json).then(s.def.success).catch(s.def.error)},me:function(){return s.auth().then(function(e){return fetch(s.url+"/_api/SP.UserProfiles.PeopleManager/GetMyProperties",{headers:s.def.headers(e)})}).then(s.def.json).then(s.def.success).catch(s.def.error)}},search:function(r,n){return s.auth().then(function(e){var t=s.url+"/_api/search/query?querytext='"+r+"'";return n&&(t+="&selectproperties='"+n+"'"),fetch(t,{headers:s.def.headers(e)})}).then(s.def.json).then(function(e){var t=e.PrimaryQueryResult.RelevantResults.Table.Rows;return console.log(t),Promise.resolve(t)}).catch(s.def.error)},web:{get:function(){return s.auth().then(function(e){return fetch(s.url+"/_api/web",{headers:s.def.headers(e)})}).then(s.def.json).then(s.def.success).catch(s.def.error)},getRegionalSettings:function(){return s.auth().then(function(e){return fetch(s.url+"/_api/web/regionalsettings",{headers:s.def.headers(e)})}).then(s.def.json).then(s.def.success).catch(s.def.error)}},site:{get:function(){return s.auth().then(function(e){return fetch(s.url+"/_api/web",{headers:s.def.headers(e)})}).then(s.def.json).then(s.def.success).catch(s.def.error)}},list:{addList:function(t,r){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists",{headers:s.def.headers(e),method:"POST",body:JSON.stringify({Title:t,BaseTemplate:r||100,ContentTypesEnabled:!0,AllowContentTypes:!0,EnableVersioning:!0})})}).then(s.def.success).catch(s.def.error)},addLibrary:function(t){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists",{headers:s.def.headers(e),method:"POST",body:JSON.stringify({Title:t,BaseTemplate:101,ContentTypesEnabled:!0,AllowContentTypes:!0,EnableVersioning:!0,EnableFolderCreation:!0})})}).then(s.def.success).catch(s.def.error)},all:function(){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists?$expand=RootFolder",{headers:s.def.headers(e)})}).then(s.def.json).then(function(e){return console.log(e.value),Promise.resolve(e.value)}).catch(s.def.error)},allTitles:function(){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists?$expand=RootFolder",{headers:s.def.headers(e)})}).then(s.def.json).then(function(e){for(var t=[],r=e.value.length;r--;)t.push(e.value[r].Title),console.log(e.value[r].Title);return Promise.resolve(t)}).catch(s.def.error)},get:function(t){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+t+"')",{headers:s.def.headers(e)})}).then(s.def.json).then(s.def.success).catch(s.def.error)},getFields:function(t){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+t+"')/fields",{headers:s.def.headers(e)})}).then(s.def.json).then(function(e){return console.log(e.value),Promise.resolve(e.value)}).catch(s.def.error)},getFieldsTitles:function(t){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+t+"')/fields",{headers:s.def.headers(e)})}).then(s.def.json).then(function(e){for(var t=[],r=e.value.length;r--;){var n=e.value[r],s=n.Title+", "+n.TypeAsString+", "+n.InternalName+", "+(1==n.Indexed?">> INDEXED":"");console.log(s),t.push(s)}return Promise.resolve(t)}).catch(s.def.error)},setHidden:function(t,r){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+t+"')",{headers:s.def.headers(e,!0),method:"POST",body:JSON.stringify({Hidden:r||!0})})}).then(s.def.success).catch(s.def.error)},setTitle:function(t,r){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+t+"')",{headers:s.def.headers(e,!0),method:"POST",body:JSON.stringify({Title:r})})}).then(s.def.success).catch(s.def.error)},setModeration:function(t,r){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+t+"')",{headers:s.def.headers(e,!0),method:"POST",body:JSON.stringify({EnableModeration:r||!0})})}).then(s.def.success).catch(s.def.error)},setVersioning:function(t,r){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+t+"')",{headers:s.def.headers(e,!0),method:"POST",body:JSON.stringify({EnableVersioning:r||!0})})}).then(s.def.success).catch(s.def.error)},setFolderCreation:function(t,r){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+t+"')",{headers:s.def.headers(e,!0),method:"POST",body:JSON.stringify({EnableFolderCreation:r||!0})})}).then(s.def.success).catch(s.def.error)},setContentTypes:function(t,r){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+t+"')",{headers:s.def.headers(e,!0),method:"POST",body:JSON.stringify({AllowContentTypes:r||!0,ContentTypesEnabled:r||!0})})}).then(s.def.success).catch(s.def.error)}},view:{all:function(t){return s.auth().then(function(e){return fetch(s.url+"/_api/lists/getByTitle('"+t+"')/views",{headers:s.def.headers(e)})}).then(s.def.json).then(function(e){return console.log(e.value),Promise.resolve(e.value)}).catch(s.def.error)},get:function(t,r){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+t+"')/views/GetByTitle('"+r+"')",{headers:s.def.headers(e)})}).then(s.def.json).then(s.def.success).catch(s.def.error)},setHidden:function(t,r,n){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+t+"')/views/GetByTitle('"+r+"')",{headers:s.def.headers(e,!0),method:"POST",body:JSON.stringify({Hidden:n||!0})})}).then(s.def.success).catch(s.def.error)},setViewQuery:function(t,r,n){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+t+"')/views/GetByTitle('"+r+"')",{headers:s.def.headers(e,!0),method:"POST",body:JSON.stringify({ViewQuery:n})})}).then(s.def.success).catch(s.def.error)},setRowLimit:function(t,r,n){return s.auth().then(function(e){return fetch(s.url+"/_api/web/lists/GetByTitle('"+t+"')/views/GetByTitle('"+r+"')",{headers:s.def.headers(e,!0),method:"POST",body:JSON.stringify({RowLimit:n})})}).then(s.def.success).catch(s.def.error)}}};